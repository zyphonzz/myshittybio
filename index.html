<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discord Bio</title>
  <style>
    body { margin: 0; font-family: sans-serif; }
    #app { display: flex; justify-content: center; align-items: center; min-height: 100vh; }

    /* Default modern style */
    body.default { background: #111; color: #fff; }
    .card { background: #222; padding: 2rem; border-radius: 1rem; box-shadow: 0 8px 24px rgba(0,0,0,.4); text-align: center; max-width: 400px; }
    .avatar { width: 96px; height: 96px; border-radius: 50%; margin-bottom: 1rem; }

    /* GeoCities */
    body.geo { background: url('https://www.transparenttextures.com/patterns/stardust.png'), #000; color: #0ff; font-family: "Comic Sans MS", cursive, sans-serif; }
    body.geo .card { background: none; border: 3px ridge magenta; color: yellow; box-shadow: none; text-shadow: 2px 2px #f0f; }

    /* Aero */
    body.aero { background: url('https://i.imgur.com/r1bI6Rw.jpg') center/cover no-repeat fixed; color: #fff; }
    body.aero .card { backdrop-filter: blur(20px); background: rgba(255,255,255,.1); border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,.4); }

    /* Metro */
    body.metro { background: #0078D7; color: #fff; font-family: "Segoe UI", sans-serif; }
    body.metro .card { background: #fff; color: #111; border-radius: 0; box-shadow: none; text-align: left; }

    /* Guns.lol imitation */
    body.guns { background: #0d0d0d; color: #fff; font-family: Arial, sans-serif; }
    body.guns .card { background: #111; border: 2px solid #333; padding: 2rem; border-radius: 12px; text-align: left; }

    /* 101 (code/terminal) */
    body.code101 { background: #000; color: #0f0; font-family: monospace; }
    body.code101 .card { background: none; border: none; box-shadow: none; text-align: left; }
  </style>
</head>
<body>
  <div id="app"><p>Loading profile...</p></div>

  <script>
    async function getUser(idOrName) {
      // Try Lanyard first
      try {
        const lanyard = await fetch(`https://api.lanyard.rest/v1/users/${idOrName}`);
        if (lanyard.ok) return (await lanyard.json()).data.discord_user;
      } catch {}

      // Fallback: DiscordLookup
      try {
        const res = await fetch(`https://discordlookup.mesavirep.xyz/v1/user/${idOrName}`);
        if (res.ok) return (await res.json()).user;
      } catch {}

      return null;
    }

    async function main() {
      const path = window.location.pathname.split("/").filter(Boolean);
      const theme = path[0] || "default";
      const user = path[1];
      document.body.className = theme === "101" ? "code101" : theme;

      if (!user) {
        document.getElementById("app").innerHTML = `<p>No user provided.</p>`;
        return;
      }

      const data = await getUser(user);
      if (!data) {
        document.getElementById("app").innerHTML = `<p>Could not fetch profile for ${user}</p>`;
        return;
      }

      const avatar = data.avatar
        ? `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png`
        : `https://cdn.discordapp.com/embed/avatars/0.png`;

      document.getElementById("app").innerHTML = `
        <div class="card">
          <img class="avatar" src="${avatar}" alt="avatar">
          <h2>${data.username}${data.discriminator !== "0" ? "#" + data.discriminator : ""}</h2>
          ${data.global_name ? `<p>${data.global_name}</p>` : ""}
        </div>
      `;
    }

    main();
  </script>
</body>
</html>
